<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Interner Bekleidungs-Shop</title>

<style>
    body{font-family:Arial, sans-serif;margin:0;padding:40px;text-align:center;}
    h1{margin-top:20px;}
    .sub{margin-bottom:35px;color:#444;}

    table{width:100%;max-width:1200px;margin:0 auto 35px;border-collapse:collapse;}
    th,td{border:1px solid #ccc;padding:7px;text-align:center;}
    th{background:#f2f2f2;}
    input[type=number]{width:55px;}
    .block{margin-top:40px;}
    button{
        background:#0073ff;color:#fff;padding:15px 25px;
        border:none;border-radius:6px;font-size:18px;cursor:pointer;
    }
    button:hover{background:#005dda;}

    .bilderbox{
        margin-top:50px;
        display:flex;gap:30px;justify-content:center;flex-wrap:wrap;
    }
    .bilderbox img{
        width:300px;border:1px solid #ccc;border-radius:6px;
    }
</style>
</head>
<body>

<!-- LOGO -->
<img src="Dinnebiergruppe_schwarz.png" alt="Logo" style="height:90px;margin-bottom:25px;">

<h1>Interner Bekleidungs-Shop</h1>
<p class="sub">Mitarbeiter kÃ¶nnen hier Arbeitskleidung auswÃ¤hlen & bestellen.<br>
Bitte pro GrÃ¶ÃŸe Menge eintragen (0 = keine Bestellung).</p>

<!-- FORMULAR --------------------------------------------------------- -->

<script>
const standorte=[
 "Berlin - GroÃŸbeerenstr.","Berlin - Holzhauser Ford","Berlin - Holzhauser Opel",
 "Berlin â€“ KurfÃ¼rstendamm","Berlin - Lichtenberg","Berlin - Marzahn","Berlin - Nordring",
 "Berlin - Pankow","Berlin - Spandau","Berlin - Wilmersdorf",
 "Leipzig - Delitzscher Landstr.","Markkleeberg - Suzuki","Markkleeberg - Wachau",
 "Oranienb. - Berliner Str.","Oranienb. - Saarlandstr.","Oranienb. - Sachsenhausener",
 "Potsdam","Pritzwalk","Wittenberge","Wittstock","Zehdenick"
];

const chefs=[
 "Herr U. Dinnebier","Herr M. Dinnebier","Herr Engelmann",
 "Herr MÃ¼ller","Herr Pilniok","Herr Schoke","Herr WÃ¼nsch"
];

const artikel=[
"T-Shirt","Hemd Kurzarm","Hemd Langarm","Polo Langarm","Polo Kurzarm","Hoodie",
"Langarmshirt","Softshelljacke","Winterjacke","Fleecejacke",
"Bluse Kurzarm","Bluse Langarm","Arbeitsjacke (Jeans)","Kapuzensteppjacke"
];

const groessen=["XS","S","M","L","XL","XXL","3XL","4XL"];
const farben=["Schwarz","WeiÃŸ"];
</script>

<h2 style="text-align:left;max-width:1200px;margin:30px auto 10px;">Mitarbeiterdaten</h2>

<div style="max-width:1200px;margin:auto;text-align:left;font-size:18px;">
    Name:<br><input type="text" id="name" style="width:350px;font-size:18px;"><br><br>
    E-Mail:<br><input type="email" id="email" style="width:350px;font-size:18px;"><br><br>

    Standort:<br>
    <select id="standort" style="width:350px;font-size:18px;">
    <script>standorte.forEach(s=>document.write(`<option>${s}</option>`));</script>
    </select><br><br>

    Vorgesetzter:<br>
    <select id="chef" style="width:350px;font-size:18px;">
    <script>chefs.forEach(c=>document.write(`<option>${c}</option>`));</script>
    </select><br><br>
</div>

<hr style="margin:40px auto;width:1200px;">

<div id="shop"></div>

<script>
let html="";
farben.forEach(f=>{
  html+=`<div class="block"><h2>${f}</h2><table><tr><th>Artikel</th>`;
  groessen.forEach(g=>html+=`<th>${g}</th>`);html+="</tr>";
  artikel.forEach(a=>{
    html+=`<tr><td>${a}</td>`;
    groessen.forEach(g=>html+=`<td><input type='number' min='0' value='0' name='${f}_${a}_${g}'></td>`);
    html+="</tr>";
  });html+="</table></div>";
});
document.getElementById("shop").innerHTML = html;
</script> <!-- wichtig, Script sauber schlieÃŸen -->

<script>
function absenden(){

   let name   = document.getElementById('name').value.trim();
   let email  = document.getElementById('email').value.trim();
   let stand  = document.getElementById('standort').value;
   let chef   = document.getElementById('chef').value;

   if(!name || !email){
        alert("Bitte Name & E-Mail eingeben.");
        return;
   }

   let bestellung = [];
   document.querySelectorAll("input[type=number]").forEach(el=>{
        if(parseInt(el.value) > 0){
            bestellung.push(`${el.name}: ${el.value}`);
        }
   });

   if(bestellung.length === 0){
        alert("Keine Artikel ausgewÃ¤hlt.");
        return;
   }

   let empfaenger = "marketing@dinnebiergruppe.de"; // intern

   let text =
`Neue Bestellung:

Name: ${name}
E-Mail: ${email}
Standort: ${stand}
Vorgesetzter: ${chef}

Bestellung:
${bestellung.join("\n")}`;

   // Ã–ffnet Outlook â€” 2 EmpfÃ¤nger: intern + Besteller
    // ðŸŸ¢ Webhook an Spreadsheet senden
fetch("https://script.google.com/macros/library/d/1GYTSkOsbmlCFJTMwaXZtOd_Rq2TjJf4pi28tH8CbqgaXD46fBPfop5dA/5",{
   method:"POST",
   headers:{"Content-Type":"application/json"},
   body:JSON.stringify({
      name:name,
      email:email,
      standort:stand,
      chef:chef,
      bestellung:bestellung
   })
});

   window.location.href =
       `mailto:${empfaenger};${email}?subject=Bekleidungsbestellung&body=${encodeURIComponent(text)}`;

   alert("âœ” Bestellung wurde vorbereitet. Bitte im E-Mail Fenster auf SENDEN klicken.");
}
</script>

<button onclick="absenden()">ðŸ›’ Bestellung absenden</button>


<!-- BILDER UNTEN ------------------------------------------------------ -->

<div class="bilderbox">
    <img src="Seite1.jpg" alt="Bild 1">
    <img src="Seite2.jpg" alt="Bild 2">
</div>

<br><br>
</body>
</html>
